---
title: 和计算机打交道的思想
date: 2022-05-05 22:02:12
updated: 2022-05-05 22:02:12
twitter: true
---

写程序，实质上是对计算机进行操作，所以最重要的是和计算机打交道的「思想」，而语言仅仅是载体。举个例子，假设一个函数`alloc(n)`返回一个指向`n`个连续字符存储单元的指针，那么为什么`alloc`函数的调用者可以利用该指针来存储字符序列？这不是「术」的问题，这体现的是对计算机的认识之「道」。

`alloc`函数实质上是向操作系统在内存里申请到了一块连续的大小为`n+1`个`char`类型数据的内存，而且这块内存用返回的指针来描述，所以调用者自然可以用该指针去操作那一块内存。没有指针，有内存也无法操作；没有内存，那就什么都没有。

引申出另一个问题，`char c[10]`和`malloc(10*sizeof(int))`的区别何在？暂且不讨论堆内存、栈内存等操作系统味道太浓的东西，只说语言本身和计算机体系结构之间的关系本身：显然最明显的区别就是前者以数据类型和数据大小来申请内存，而后者仅以数据大小来申请，甚至后者没有「数据」的概念，只有大小。

再深入一些，前者申请的内存会随着程序本身的销毁而自动回收，而后者申请的内存必须要手动`free()`释放才能释放，否则就一直被占用。这些东西，大约就体现了「底层」的意义：还能这么写？怎么想到的？答案就是就应该是这样，很自然。理解不了也不应记下之后去用，尝试理解，或者放弃使用该特性，否则......