---
title: 2022年6月份的微博整理
date: 2022-06-30 14:19:37
updated: 2022-06-30 14:19:37
twitter: true
draft:
pinned:
---

## 2022/06/28：

（一）

计算是对信息进行控制。换句话说，对已知信息进行某种加工，从而得出一些未知信息。

>计算理论是数学的一个领域，和计算机有密切关系。其中的理论是现代密码协议、计算机设计和许多应用领域的基础。该领域主要关心三个方面的问题：采用什么计算模型（即形式语言、自动机），解决哪些是可计算的、不可计算的（即可计算性理论及演算法），要用多少时间、要用多少存储（即计算复杂性理论）。这三方面的问题可以用一个问题来总括：“电脑的基础能力及限制到什么程度？”计算理论的“计算”并非指纯粹的算术运算（Calculation），而是指从已知的输入透过算法来取得一个问题的答案（Computation），因此，计算理论属于理论计算机科学和应用数学。

最近在想一个问题，「什么是计算」？得出的几个结论：计算是对已知信息进行加工从而得出未知信息的过程；最简单的计算是确定因子，即确定该因子携带的信息；目前的计算机能进行数字和逻辑运算，其实质是一种状态机，即从一种确定状态向另一种确定状态转换；信息论和控制论或许可以帮助解答这个问题。

最近注意到的一个有趣的观点：计算机和计算机程序都是状态机。计算机实际上是一个大型复杂数字电路，在每个时钟周期到来时，根据当前时序逻辑部件的状态，在组合逻辑部件的作用下，计算出并转移到下一时钟周期的新状态之中，周而复始。这其实就是图灵机的一种偏向于数字电路的表述。

至于说计算机程序，我们可以假设某计算机的时序逻辑部件（存储器）具有N个可能状态，那么某一时刻计算机则必定处于N的一个子集n1之中，程序此时即可对n1状态下的计算机进行操作，使其进入n2状态。显然将「软件的程序操作」实现为「硬件的电气状态」的部件即为组合逻辑部件，一般叫ALU。

留个问题在这儿：此处的「程序操作」，必须是ISA中规定的操作吗？比如我写一个`z=x+y;`的C语句，该语句对计算机的操作能否视作这里状态机视角下的「程序操作」？我个人倾向于必须是ISA中规定操作，不过目前我还说服不了我自己——高级语言语句也是实现从一状态到另一状态，只是过程中有很多微结构层次上的细粒度操作而已。

（二）

偶尔的想法。计算机是一个大型状态机，在时序逻辑的基础上运行组合逻辑：通过对初状态的处理到达末状态，这天然就决定了计算机必须要有可读写的存储器来实现时序逻辑。对动物而言，动物的大脑能做到可读写地存储信息，脊髓和部分大脑可以做到对特定输入反应特定输出。

其中，脊髓这类具有反射功能的神经系统中我觉得存在着某种程度上的「固件」，即动物DNA控制形成的神经突触，比如缩手反应和膝跳反射等。动物的行为则是通过脊髓和大脑同时来控制的，从这个角度上，我觉得可以把动物的神经中枢理解为CPU、内存和闪存。

CPU处理数据同时控制肢体，内存存放后天习得的数据，其中部分数据置于闪存中永久保存，另外还有一部分DNA控制的数据也置于闪存中。

我总觉得现有的计算机就是在模拟什么东西…比如我面前的桌面，比如动物的神经中枢。也许可以换个词，不是模拟，是类似，这些信息处理系统都是类似的。

模模糊糊地，我也总觉得我对计算机有种很奇怪的感觉，好像某种看法在酝酿着积压着，但是具体什么看法我还说不出来......

## 2022/06/23：

一个小细节：浏览器等终端中，鼠标双击或手指长按/双击屏幕时，有部分实现会默认选中一些词语，譬如一句话「中国是一个统一多民族国家。」，Chrome可能会分词为「中国 是 一个 统一 多 民族 国家。」，FireFox或许就会分词为「中国 是一个 统一 多民族国家」，可能还有些浏览器直接不分词，全部选中。

对英语来说，这个逻辑很容易理解，按照空格来分词就好了，那汉语呢？我们要坚持一个理念：只要没有人特意做出某种功能，那机器永远不会主动具有某种正向特性，除非是副产品。我们看来，双击默认能选中中文词语是很自然的事情，也简单到仿佛匹配个「词库」就能做出来，但这事其实远没这么简单。

比如，我刚刚路过的「济南幼儿师范高等专科学校」，如果选中「科学」，那就很奇怪，默认选中「专科学校」甚至这整个的专有名词才比较正确。事实上，Telegram就默认没有加入中文分词引擎，如果想要检索某条中文消息，那必须全句匹配，否则你只能自己手动以空格进行分词——即英语的分词方式。

某种角度上，英语确实是最适合计算机表示、处理的语言。

## 2022/06/13：

（一）

电子实习要用个ESP32那种的模块接一些传感器搭出个东西，扩展内容是做个Web页面和移动端APP显示。移动端APP和Web页面没有本质区别，而页面本身就带来了问题：ESP32可以借助MQTT等物联协议实现广域网范围内的JSON数据上传，页面图表之类可以用EChart等库在前端渲染显示，那页面本身，放在哪儿？

一开始考虑，完全没必要上云——既然上云那为何还要用MQTT？边缘设备用WebSocket长连接直接和服务器通信不就好了？还去用第三方的物联平台岂不是多此一举？前段时间某不不具名人士问我类似问题，我也按照这个思路给了回答，现在来看，基本是全都错了

今晚想到的结论是：首先，协议的选择标准不应是「可以用」，而应该是「适合用」。比如说此处的协议选择，对少数几个设备而言，MQTT和WebSocket均可用来通信，二者没有本质区别，只是前者要走一套独立的协议栈，传输数据是定死的JSON，后者则灵活性更强，数据格式可魔改，也不用再走独立第三方协议栈。

那选什么？少数几个开发测试用设备当然WebSocket更方便，但问题在于，方便不见得就规范。MQTT协议设计出来就是为了物联通信，各个指标等均点对点进行了调整，而WebSocket做这个事，属于临时借调工，方便是方便，但效果注定不会有多好。为什么要用MQTT多走一遍第三方协议栈？因为物联设备就该这么玩。

其次，ESP32本身固件可以提供简单的Web服务，其硬件资源也基本足够跑个剪裁过的Web服务，完全可以通过一些方式直接把静态页面放到它里面然后请求到客户端浏览器中，那为什么还建议大动干戈再上云，把Web服务单独拎出来？

这个问题核心在于，边缘计算设备专用性很强，它压根儿就不适合用来做抗压的服务承载，它的使命就是把收集到的数据简单处理后发给下一级，仅此而已。如果要求它有更多更复杂的功能，那就脱离它的工作情景了，属于凑合着开发测试用还行，但是绝不建议大规模部署，否则事故频率恐怕会直线上升。

最后，实际举个例子，比如小米的物联网系统。我们买了一堆小米设备，将其联网后可以访问某个网页或APP来对其进行监视和操作等，这个过程中，这些边缘计算设备即通过物联协议（或许不止MQTT）和小米云服务进行通信，而我们则直接请求小米云服务，用户请求和设备上载的压力完全由该服务承担。否则会炸！

（二）

加速度传感器输出一堆意义不明的十六进制数，得按照手册上的私有协议将其解析为三维坐标数据；ESP32用串口接受到数据之后做这个解析的活，解析完毕把它们以MQTT协议作为发布者发送到代理，后面的事情就和这些小东西无关了。洗好的数据怎么用，以什么算法搞出些什么奇怪功能，就是另外一码事了。

代理方面，先是在Azure东京机房开了个IoT hub，奈何校园网直接屏蔽掉对应IP的Websocket数据包，总之是用不了。最后还是用了阿里的。计划在代理层面上把ESP32发布来的三维加速度数据进行二次加工，阿里云也很适合干这个事，操作台上就给了JavaScript、Python2和PHP的支持

二次加工好的数据再转发到订阅者那里，老师给的要求是上位机显示，那就先给他来一套Web再说，其中一个略微复杂一些的问题就是MQTT和HTTP的转换，不过估计会有不少现成的解决方案。绘图之类的老掉牙套路了，用Echart。实验室不少人用Qt写客户端，而我要用Electron，因为懒。

好一个调包小玩具！

这类玩具虽然没什么技术含量，但是很好玩啊，很容易让人沉迷其中咣咣往下做，十分有成就感。

（三）

没有操作系统，意味着没有并行概念，所以今晚所做的全都是徒劳......

两个任务在跑，一个是把传感器从串口给的原始十六进制数据解析成三维加速度数据json，采样率大概每秒几百次，一个是连mqtt作为发送端。我本想以信号量的形式让两个任务交替读写两个全局变量，但是没有os，唯一的一个_thread库还只支持锁，可要用锁的话就完全没了并行概念，全然是在你用我等。

多线程实现缓冲池可以实现边接收传感器数据边通过mqtt上传，即并行发送与接收。如果不用多线程，那必然要面对的一个问题就是发的时候还收不收？如果不收，那每隔一段时间就有几十ms的数据丢失怎么解决？最后没办法，只能降低采样率。

每100ms甚至200ms接受一次传感器数据，再在接收完数据的周期空白时间里进行发送工作，两个任务不断切换。最后今天也懒得实现了，这种实现方式完全不是我想要的效果......

下面的伪代码，如果有OS的支持能直接跑起来该有多美好......

```Python
from asyncio import locks
from machine import Timer
import tomqtt, sensor, _thread


sempJsonOne = _thread.allocate_semephare()
sempJsonTwo = _thread.allocate_semephare()

tomqtt.creatConnect()

def runHeartBeat():
  tim = Timer(-1)
  tim.init(period = 110000, mode = Timer.PERIODIC, callback = tomqtt.runHeartBeat)

def runMqttThread():
  sempJsonOne.pend()
  tomqtt.runPublishData(json = json_one)
  sempJsonTwo.pend()
  tomqtt.runPublishData(json = json_two)

def runSensorThread():
  sensor.runSensor(json = tomqtt.json_one)
  sempJsonOne.post()
  sensor.runSensor(json = tomqtt.json_two)
  sempJsonTwo.post()


_thread.start_new_thread(runSensorThread)
_thread.start_new_thread(runMqttThread)
_thread.start_new_thread(runHeartBeat)
```

## 2022/06/04：

所谓的「web前后端」系统，一言以蔽之：浏览器里的JavaScript调一些HTTP API，与同样调HTTP API的服务器后端进程通信，这个后端用什么语言无所谓，有运行环境就可以。

想说了，就多说点：目前而言，浏览器里最基本的还是HTML，超文本标记语言，可以理解为是一种数据堆叠的结构化文档，与其配合的是CSS，层叠样式表，为HTML这种结构化文档增加一些描述信息，比如字体大小、背景颜色等。浏览器的作用之一就是将CSS描述的HTML渲染成页面，实现从「代码」到「成果」的转换。

但仅仅有HTML和CSS还远远不够，人们有更为高级的需求，即动态页面。举个最简单的例子，如果访问者性别为「男」，那你就不应该再向他展示一些女性生理用品。没错，就这么一个简单的「逻辑」，就需要创造一门编程语言。因为HTML终究只是文档，数据的堆叠而已，CSS只不过加了一些补充信息，谈不上逻辑。

编程语言最核心的功能，我认为就是向计算机表明操作「逻辑」，即「在某种条件下它应该对什么对象有什么行为」。如果访问者选择了男性性别，那么就不该展示卫生巾信息。这类有逻辑交互的功能，仅凭HTML和CSS是很难实现的。所以就诞生了JavaScript，这种跑在浏览器里的编程语言。

事实上，通过调用操作系统提供的API而向外界发送HTTP请求这个功能，是由浏览器实现的。浏览器怎么知道它什么时候该发什么请求？超链接，比如HTML提供的`<a>`标签。那作为浏览器里跑的编程语言，JavaScript能告诉浏览器它什么时候发什么请求吗？当然能，从头实现很复杂，但是调现成的方法却很简单。

以上就是所谓的「前端」，即用户浏览器里跑的东西。前端需要做的就是展示页面逻辑，然后把用户的操作如实以HTTP请求的方式发送给后端。后端就更简单了，只需要监听某个特定端口，一般是80或者443，每当有请求过来，则web服务进程会自动将某个特定路径下的文件作为响应反馈给前端，供其展示。

可这不就又产生了新问题？你只能返回静态文件，不能根据前端请求中的某些参数返回动态响应。举例，web目录有个可执行文件可将传入的两个参数`$a`和`$b`加和后输出结果`$c`，此时前端请求该可执行文件运算`$a=1`与`$b=1`加和后的结果，但你却只能返回静态文件，会发生什么？你会把这个文件本身返回给前端！

所以，现代web服务都可把某些请求转发给特定的解析进程。譬如刚刚的加和程序如果是用PHP写的，那么web服务就会把这个请求参数一并转发给PHP解释器，请求其以对应参数为操作数据执行该目录下的源码文件。这种以加和程序为例对外界请求进行特定操作然后产生响应的程序，就是我们需要编写的所谓「后端」。

这里就有另外一个问题，后端用什么语言？什么语言最终都要转化为二进制程序加载到内存中执行，所以本质上它们没有区别，只是在一些实现方法上有一定不同，比如Java的JRE等。什么是运行环境？就是能够把你编写的代码转换为计算机能懂的二进制语言的程序。PHP解释器也好，Gcc也罢，都是这个作用。

为什么你向后端请求某个东西，后端能给你？换句话说，为什么后端计算机有这个「功能」？因为有我们编写的程序进程在！它在操作系统的包裹下一直在运行，所以后端计算机才在这个「软件」的支持下有了这个特定功能！

## 2022/06/03：

比赛进行到一半，某个学院副书记评委已经把基本所有人的分数都打完了。我盯着数据库，叫来我的指导老师，说需不需要问一下，老师说不用，又让我查一下他给他学院参赛的两个辅导员的成绩，果然，最高。老师说这事谁也别说，很多事你们这个层次还不能考虑。

活动结束，学生全部去接待室室等候，学工处处长给辅导员和学院副书记开会讲话，主题是做好学生特别是毕业生的心理健康工作，尤其要做好18级300多个不能毕业学生的工作。

不少辅导员在介绍个人工作时，表示自己已经有了一套工作理念，比如「五四一」工作理念，「1+1＞2」工作总思路，等等。指导老师和我说，孩子咱有技术干点啥都行，千万不要来干这个辅导员，太恐怖了，太卷了。

在活动结束的合影留念环节，党委副书记拿过话筒说，「我是硬要讲这几句的，不是应邀」，她说，大家也要做好自己的心理疏导工作，大家对学生应该是既辅又导，不要再让我给大家辅导了，都要露出最灿烂的笑容来合影。分管学生工作的党委副书记，50+，党委学生工作处处长，40+，下辖科长，30+，普通一线辅导员，一般在30岁左右。

你说我和30多岁的科长，在看一些内容的时候有差距吗？那肯定还是有的，就比如这个提出自己「工作理念」的问题，就是他提出的，而我并没有特别清晰的逻辑去评价这些辅导员们的工作。

每次盯活动，都会带来很多思考，一些小细节小事情，能体现特别多的东西。为什么说基层磨炼人？我觉得和这种思考不无关系。

过程中有个问题：中间的大屏幕是32:9的超宽屏比例，而在场的学生不会把显卡输出分辨率调成对应比例的分辨率，所以就只能用32:9的屏幕去拉伸显示16:9的分辨率，显示效果很差劲（PPT里的照片严重变形）。指导老师让我帮帮忙，我给他们调了一下。可尴尬的是，虽然调整后的输出分辨率是32:9比例了，但参赛老师的PPT却都是16:9，没有任何一个老师做了32:9的PPT，所以调整后的效果反倒不如调整前的拉伸（左右两边有特别大的黑边），然后就又调回去了......这时候领导来了，问在调什么呢，老师一通解释，领导说哎呀这不就挺好的吗，屏幕这么宽变形也正常。指导老师的另一个平级同事过一会儿也过来说，大家都一样就这个样，咋就你不一样，就这样就行，听我的，不用管它，就这样。

再说一个。可以看出，参赛老师们的电脑操作水平参差不齐，各种字体、动画和转场层出不穷，另加不同版本的WPS和Office不兼容，现场简直是灾难。我习惯性地根据一个人的PPT水平去给这个人打第一印象分，这就导致我对他的内容本身不太注重，而指导老师却很迅速地指出说参赛者们居然都在谈自己的工作理念。换句话说，我以前会觉得，这个人连最基本的PPT逻辑都做不清楚，那其他地方肯定也不会怎么样。但指导老师会更专注于内容本身，当然他工作那么多年，对政教工作本身也更了解。可事实就是，大部分人的工作内容不包含思考PPT排版和逻辑整合啊……PPT逻辑清楚，可能工作能力强的概率更大，但不会做PPT，也不见得就做不好工作，而工作本身又是从内容上来体现的，而不是排版和逻辑。这么简单的道理，但当你被极其主观的偏见裹挟的时候，就会也想不通，智力下降得厉害。

懂电脑的，有两种人，一种是计算机行业专业人士，一种是数码爱好者。前者懂计算机组成原理懂七层网络协议，但不见得会攒机配软路由；后者会选杀毒软件会搭NAS，但不见得懂操作系统懂机械硬盘分区表。